this is completed code i forked from  wesm
